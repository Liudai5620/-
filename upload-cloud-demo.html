<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº‘å­˜å‚¨ä¸Šä¼ æ¼”ç¤º - æ”¯æŒä»»æ„å¤§å°æ–‡ä»¶</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .gradient-text {
            background: linear-gradient(90deg, #8b5cf6, #3b82f6, #22c55e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .upload-zone {
            border: 3px dashed #8b5cf6;
            transition: all 0.3s;
        }
        .upload-zone:hover, .upload-zone.drag-over {
            border-color: #3b82f6;
            background-color: rgba(139, 92, 246, 0.05);
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-green-50">
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- å¤´éƒ¨ -->
        <div class="mb-8 text-center">
            <h1 class="text-3xl sm:text-4xl font-bold gradient-text mb-2">â˜ï¸ äº‘å­˜å‚¨ä¸Šä¼ æ¼”ç¤º</h1>
            <p class="text-gray-600 text-sm sm:text-base">æ”¯æŒä»»æ„å¤§å°æ–‡ä»¶ä¸Šä¼ ï¼Œæ— å­˜å‚¨é™åˆ¶ï¼</p>
            <div class="mt-4 flex flex-wrap justify-center gap-2">
                <span class="inline-flex items-center rounded-full bg-green-100 px-3 py-1 text-green-800 text-xs sm:text-sm">
                    âœ… æ— å¤§å°é™åˆ¶
                </span>
                <span class="inline-flex items-center rounded-full bg-blue-100 px-3 py-1 text-blue-800 text-xs sm:text-sm">
                    âœ… äº‘ç«¯å­˜å‚¨
                </span>
                <span class="inline-flex items-center rounded-full bg-purple-100 px-3 py-1 text-purple-800 text-xs sm:text-sm">
                    âœ… é«˜é€Ÿä¸Šä¼ 
                </span>
            </div>
        </div>

        <!-- ä¸Šä¼ åŒºåŸŸ -->
        <div class="bg-white rounded-2xl shadow-xl p-6 sm:p-8 mb-8">
            <h2 class="text-xl sm:text-2xl font-bold mb-4">ä¸Šä¼ æ–°èµ„æº</h2>

            <!-- ä¸Šä¼ æ–¹å¼é€‰æ‹© -->
            <div class="mb-6">
                <label class="block text-sm font-bold text-gray-700 mb-2">ä¸Šä¼ æ–¹å¼</label>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-2">
                    <button
                        type="button"
                        onclick="setUploadMode('url')"
                        id="mode-url"
                        class="upload-mode-btn px-4 py-3 rounded-xl border-2 border-gray-200 bg-white text-gray-700 font-bold text-sm sm:text-base"
                    >
                        ğŸ”— ç½‘ç»œé“¾æ¥
                        <span class="block text-xs font-normal mt-1">ç²˜è´´ç½‘ç›˜é“¾æ¥</span>
                    </button>
                    <button
                        type="button"
                        onclick="setUploadMode('cloud')"
                        id="mode-cloud"
                        class="upload-mode-btn active px-4 py-3 rounded-xl border-2 border-purple-500 bg-purple-50 text-purple-700 font-bold text-sm sm:text-base"
                    >
                        â˜ï¸ äº‘å­˜å‚¨
                        <span class="block text-xs font-normal mt-1">æ¨èï¼Œæ— å¤§å°é™åˆ¶</span>
                    </button>
                    <button
                        type="button"
                        onclick="setUploadMode('base64')"
                        id="mode-base64"
                        class="upload-mode-btn px-4 py-3 rounded-xl border-2 border-gray-200 bg-white text-gray-700 font-bold text-sm sm:text-base"
                    >
                        ğŸ’¾ æœ¬åœ°å­˜å‚¨
                        <span class="block text-xs font-normal mt-1">å»ºè®®å°äº10MB</span>
                    </button>
                </div>
                <p id="mode-hint" class="mt-2 text-sm text-gray-500">
                    âœ¨ æ¨èï¼šæ–‡ä»¶å°†ä¸Šä¼ åˆ°äº‘ç«¯ï¼Œæ— å¤§å°é™åˆ¶ï¼Œæ”¯æŒé«˜é€Ÿä¼ è¾“
                </p>
            </div>

            <form id="uploadForm" onsubmit="handleUpload(event)">
                <div class="mb-4">
                    <label class="block text-sm font-bold text-gray-700 mb-2">èµ„æºç±»å‹</label>
                    <select
                        id="resourceType"
                        class="w-full rounded-xl border-2 border-gray-200 px-4 py-3 focus:border-purple-500 focus:outline-none"
                        required
                    >
                        <option value="video">ğŸ¬ è§†é¢‘å¾®è¯¾</option>
                        <option value="ppt">ğŸ“Š PPTè¯¾ä»¶</option>
                        <option value="ai">ğŸ¤– AIäº’åŠ¨</option>
                    </select>
                </div>

                <!-- URL æ¨¡å¼ -->
                <div id="url-mode-fields" class="hidden">
                    <div class="mb-4">
                        <label class="block text-sm font-bold text-gray-700 mb-2">èµ„æºé“¾æ¥</label>
                        <input
                            type="url"
                            id="urlInput"
                            placeholder="https://example.com/file.mp4"
                            class="w-full rounded-xl border-2 border-gray-200 px-4 py-3 focus:border-purple-500 focus:outline-none"
                            required
                        />
                        <p class="mt-1 text-xs text-gray-500">ç²˜è´´æ–‡ä»¶çš„ç›´æ¥ä¸‹è½½é“¾æ¥æˆ–ç½‘ç›˜åˆ†äº«é“¾æ¥</p>
                    </div>
                </div>

                <!-- Base64 æ¨¡å¼ï¼ˆéšè—ï¼‰ -->
                <div id="base64-mode-fields" class="hidden">
                    <div class="mb-4">
                        <label class="block text-sm font-bold text-gray-700 mb-2">é€‰æ‹©æ–‡ä»¶</label>
                        <input
                            type="file"
                            id="fileInput"
                            accept=".mp4,.webm,.ogg,.ppt,.pptx,.html,.json,.txt,.pdf,.doc,.docx"
                            class="w-full rounded-xl border-2 border-gray-200 px-4 py-3 focus:border-purple-500 focus:outline-none"
                        />
                        <p class="mt-1 text-xs text-gray-500">æ”¯æŒï¼šè§†é¢‘ã€PPTã€PDFã€æ–‡æ¡£ç­‰ï¼ˆå»ºè®®å°äº10MBï¼‰</p>
                    </div>
                </div>

                <!-- äº‘å­˜å‚¨æ¨¡å¼ -->
                <div id="cloud-mode-fields">
                    <div class="mb-4">
                        <label class="block text-sm font-bold text-gray-700 mb-2">é€‰æ‹©æ–‡ä»¶ï¼ˆæ”¯æŒä»»æ„å¤§å°ï¼‰</label>
                        <div
                            id="dropZone"
                            class="upload-zone rounded-xl p-8 text-center cursor-pointer"
                            onclick="document.getElementById('fileInputCloud').click()"
                        >
                            <input
                                type="file"
                                id="fileInputCloud"
                                accept=".mp4,.webm,.ogg,.ppt,.pptx,.html,.json,.txt,.pdf,.doc,.docx"
                                class="hidden"
                                onchange="handleFileSelect(event)"
                            />
                            <div id="dropZoneContent">
                                <div class="text-6xl mb-4">â˜ï¸</div>
                                <p class="text-lg font-bold text-gray-700 mb-2">ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°è¿™é‡Œ</p>
                                <p class="text-sm text-gray-500">æ”¯æŒä»»æ„å¤§å°çš„è§†é¢‘ã€PPTã€æ–‡æ¡£ç­‰</p>
                            </div>
                            <div id="selectedFileInfo" class="hidden">
                                <div class="text-4xl mb-2">ğŸ“„</div>
                                <p id="selectedFileName" class="font-bold text-gray-900 mb-1"></p>
                                <p id="selectedFileSize" class="text-sm text-gray-600"></p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mb-4">
                    <label class="block text-sm font-bold text-gray-700 mb-2">èµ„æºæ ‡é¢˜</label>
                    <input
                        type="text"
                        id="titleInput"
                        placeholder="ä¾‹å¦‚ï¼šå°æ˜Ÿæ˜Ÿå„¿æ­Œ"
                        class="w-full rounded-xl border-2 border-gray-200 px-4 py-3 focus:border-purple-500 focus:outline-none"
                        required
                    />
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-bold text-gray-700 mb-2">èµ„æºæè¿°ï¼ˆå¯é€‰ï¼‰</label>
                    <textarea
                        id="descriptionInput"
                        placeholder="ä¾‹å¦‚ï¼šé€‚åˆ3-4å²å¹¼å„¿çš„ç»å…¸å„¿æ­Œæ•™å­¦"
                        rows="3"
                        class="w-full rounded-xl border-2 border-gray-200 px-4 py-3 focus:border-purple-500 focus:outline-none"
                    ></textarea>
                </div>

                <button
                    type="submit"
                    id="submitBtn"
                    class="w-full rounded-xl bg-gradient-to-r from-purple-500 via-blue-500 to-green-500 px-6 py-4 font-bold text-white transition-all hover:scale-105 hover:shadow-lg text-lg"
                >
                    â˜ï¸ ä¸Šä¼ åˆ°äº‘ç«¯
                </button>
            </form>
        </div>

        <!-- ç­›é€‰æŒ‰é’® -->
        <div class="mb-6 flex flex-wrap justify-center gap-3">
            <button
                onclick="filterResources('all')"
                id="btn-all"
                class="filter-btn px-4 py-2 rounded-full font-bold transition-all duration-200 transform hover:scale-105 bg-gradient-to-r from-purple-500 via-blue-500 to-green-500 text-white shadow-lg text-sm sm:text-base"
            >
                ğŸ“¦ å…¨éƒ¨èµ„æº
            </button>
            <button
                onclick="filterResources('video')"
                id="btn-video"
                class="filter-btn px-4 py-2 rounded-full font-bold transition-all duration-200 transform hover:scale-105 bg-white text-gray-700 hover:shadow-md text-sm sm:text-base"
            >
                ğŸ¬ è§†é¢‘å¾®è¯¾
            </button>
            <button
                onclick="filterResources('ppt')"
                id="btn-ppt"
                class="filter-btn px-4 py-2 rounded-full font-bold transition-all duration-200 transform hover:scale-105 bg-white text-gray-700 hover:shadow-md text-sm sm:text-base"
            >
                ğŸ“Š PPTè¯¾ä»¶
            </button>
            <button
                onclick="filterResources('ai')"
                id="btn-ai"
                class="filter-btn px-4 py-2 rounded-full font-bold transition-all duration-200 transform hover:scale-105 bg-white text-gray-700 hover:shadow-md text-sm sm:text-base"
            >
                ğŸ¤– AIäº’åŠ¨
            </button>
        </div>

        <!-- å­˜å‚¨æ¨¡å¼ç»Ÿè®¡ -->
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6">
            <div class="bg-white rounded-xl shadow-lg p-4">
                <div class="text-sm text-gray-600">äº‘å­˜å‚¨èµ„æº</div>
                <div id="cloudCount" class="text-2xl font-bold text-purple-600">0</div>
            </div>
            <div class="bg-white rounded-xl shadow-lg p-4">
                <div class="text-sm text-gray-600">é“¾æ¥èµ„æº</div>
                <div id="urlCount" class="text-2xl font-bold text-blue-600">0</div>
            </div>
            <div class="bg-white rounded-xl shadow-lg p-4">
                <div class="text-sm text-gray-600">æœ¬åœ°å­˜å‚¨</div>
                <div id="base64Count" class="text-2xl font-bold text-green-600">0</div>
            </div>
        </div>

        <!-- èµ„æºåˆ—è¡¨ -->
        <div class="bg-white rounded-2xl shadow-xl p-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl sm:text-2xl font-bold">èµ„æºåˆ—è¡¨</h2>
                <button
                    onclick="clearAllResources()"
                    class="px-4 py-2 rounded-lg bg-red-500 text-white font-bold text-sm hover:bg-red-600 transition-all"
                >
                    æ¸…ç©ºæ‰€æœ‰
                </button>
            </div>
            <div id="resources-container">
                <!-- èµ„æºåˆ—è¡¨å°†é€šè¿‡ JavaScript åŠ¨æ€åŠ è½½ -->
            </div>
        </div>
    </div>

    <!-- ä¸Šä¼ è¿›åº¦æç¤º -->
    <div id="uploadProgress" class="fixed inset-0 z-50 hidden flex items-center justify-center" style="background-color: rgba(0,0,0,0.9)">
        <div class="text-center text-white">
            <div class="mb-4">
                <svg class="mx-auto h-16 w-16 animate-spin" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
            </div>
            <p id="uploadStatus" class="text-lg">ä¸Šä¼ ä¸­...</p>
            <p id="uploadPercent" class="text-sm text-gray-400 mt-2">0%</p>
        </div>
    </div>

    <!-- å¼•å…¥äº‘å­˜å‚¨ä¸Šä¼ æ¨¡å— -->
    <script src="uploadHandler-cloud.js"></script>

    <script>
        // åˆå§‹åŒ–ä¸Šä¼ å¤„ç†å™¨
        const uploadHandler = new UploadHandlerCloud({
            storageKey: 'cloudDemoResources',
            maxFileSize: 10 * 1024 * 1024, // 10MBï¼ˆä»…ç”¨äº Base64 æ¨¡å¼ï¼‰
            apiEndpoint: '/api/upload' // äº‘å­˜å‚¨ API ç«¯ç‚¹
        });

        // å½“å‰é€‰ä¸­çš„ç­›é€‰ç±»å‹
        let selectedType = 'all';

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            renderResources();
            updateStorageStats();
            setupDragAndDrop();
        });

        // è®¾ç½®æ‹–æ‹½ä¸Šä¼ 
        function setupDragAndDrop() {
            const dropZone = document.getElementById('dropZone');

            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            ['dragenter', 'dragover'].forEach(eventName => {
                dropZone.addEventListener(eventName, () => {
                    dropZone.classList.add('drag-over');
                }, false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, () => {
                    dropZone.classList.remove('drag-over');
                }, false);
            });

            dropZone.addEventListener('drop', (e) => {
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    const fileInput = document.getElementById('fileInputCloud');
                    const dataTransfer = new DataTransfer();
                    dataTransfer.items.add(files[0]);
                    fileInput.files = dataTransfer.files;
                    handleFileSelect({ target: fileInput });
                }
            }, false);
        }

        // å¤„ç†æ–‡ä»¶é€‰æ‹©
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;

            const dropZoneContent = document.getElementById('dropZoneContent');
            const selectedFileInfo = document.getElementById('selectedFileInfo');
            const selectedFileName = document.getElementById('selectedFileName');
            const selectedFileSize = document.getElementById('selectedFileSize');

            dropZoneContent.classList.add('hidden');
            selectedFileInfo.classList.remove('hidden');

            selectedFileName.textContent = file.name;
            selectedFileSize.textContent = uploadHandler.formatFileSize(file.size);
        }

        // è®¾ç½®ä¸Šä¼ æ–¹å¼
        function setUploadMode(mode) {
            uploadHandler.setUploadMode(mode);

            const urlModeFields = document.getElementById('url-mode-fields');
            const base64ModeFields = document.getElementById('base64-mode-fields');
            const cloudModeFields = document.getElementById('cloud-mode-fields');
            const modeHint = document.getElementById('mode-hint');
            const submitBtn = document.getElementById('submitBtn');

            const urlBtn = document.getElementById('mode-url');
            const base64Btn = document.getElementById('mode-base64');
            const cloudBtn = document.getElementById('mode-cloud');

            const urlInput = document.getElementById('urlInput');
            const fileInput = document.getElementById('fileInput');
            const fileInputCloud = document.getElementById('fileInputCloud');

            // é‡ç½®æŒ‰é’®æ ·å¼
            [urlBtn, base64Btn, cloudBtn].forEach(btn => {
                btn.classList.remove('border-purple-500', 'bg-purple-50', 'text-purple-700', 'active');
                btn.classList.add('border-gray-200', 'bg-white', 'text-gray-700');
            });

            if (mode === 'url') {
                urlModeFields.classList.remove('hidden');
                base64ModeFields.classList.add('hidden');
                cloudModeFields.classList.add('hidden');
                modeHint.textContent = 'ç²˜è´´ç½‘ç›˜åˆ†äº«é“¾æ¥ï¼Œå¿«é€Ÿæ·»åŠ èµ„æº';
                submitBtn.textContent = 'ğŸ”— æ·»åŠ èµ„æº';

                urlBtn.classList.add('border-purple-500', 'bg-purple-50', 'text-purple-700', 'active');
                urlBtn.classList.remove('border-gray-200', 'bg-white', 'text-gray-700');
                urlInput.required = true;
                fileInput.required = false;
                fileInputCloud.required = false;
            } else if (mode === 'base64') {
                urlModeFields.classList.add('hidden');
                base64ModeFields.classList.remove('hidden');
                cloudModeFields.classList.add('hidden');
                modeHint.textContent = 'æ–‡ä»¶å°†è½¬æ¢ä¸º Base64 ç¼–ç å­˜å‚¨åœ¨æµè§ˆå™¨æœ¬åœ°ï¼ˆå»ºè®®å°äº10MBï¼‰';
                submitBtn.textContent = 'ğŸ’¾ ä¿å­˜åˆ°æœ¬åœ°';

                base64Btn.classList.add('border-purple-500', 'bg-purple-50', 'text-purple-700', 'active');
                base64Btn.classList.remove('border-gray-200', 'bg-white', 'text-gray-700');
                urlInput.required = false;
                fileInput.required = true;
                fileInputCloud.required = false;
            } else {
                urlModeFields.classList.add('hidden');
                base64ModeFields.classList.add('hidden');
                cloudModeFields.classList.remove('hidden');
                modeHint.textContent = 'âœ¨ æ¨èï¼šæ–‡ä»¶å°†ä¸Šä¼ åˆ°äº‘ç«¯ï¼Œæ— å¤§å°é™åˆ¶ï¼Œæ”¯æŒé«˜é€Ÿä¼ è¾“';
                submitBtn.textContent = 'â˜ï¸ ä¸Šä¼ åˆ°äº‘ç«¯';

                cloudBtn.classList.add('border-purple-500', 'bg-purple-50', 'text-purple-700', 'active');
                cloudBtn.classList.remove('border-gray-200', 'bg-white', 'text-gray-700');
                urlInput.required = false;
                fileInput.required = false;
                fileInputCloud.required = true;
            }
        }

        // å¤„ç†ä¸Šä¼ 
        async function handleUpload(event) {
            event.preventDefault();

            const type = document.getElementById('resourceType').value;
            const title = document.getElementById('titleInput').value;
            const description = document.getElementById('descriptionInput').value;

            // æ˜¾ç¤ºè¿›åº¦
            const progress = document.getElementById('uploadProgress');
            const status = document.getElementById('uploadStatus');
            const percent = document.getElementById('uploadPercent');
            progress.classList.remove('hidden');
            status.textContent = 'ä¸Šä¼ ä¸­...';
            percent.textContent = '0%';

            try {
                if (uploadHandler.uploadMode === 'url') {
                    const url = document.getElementById('urlInput').value;
                    status.textContent = 'æ·»åŠ é“¾æ¥...';
                    uploadHandler.addResourceByUrl({ type, title, url, description });
                } else if (uploadHandler.uploadMode === 'base64') {
                    const file = document.getElementById('fileInput').files[0];
                    status.textContent = 'è½¬æ¢æ–‡ä»¶ä¸­...';
                    await uploadHandler.addResourceByBase64({ file, type, title, description });
                } else {
                    const file = document.getElementById('fileInputCloud').files[0];
                    status.textContent = 'ä¸Šä¼ åˆ°äº‘ç«¯...';

                    // æ¨¡æ‹Ÿä¸Šä¼ è¿›åº¦
                    let uploadProgress = 0;
                    const progressInterval = setInterval(() => {
                        uploadProgress += 10;
                        if (uploadProgress <= 90) {
                            percent.textContent = uploadProgress + '%';
                        }
                    }, 200);

                    await uploadHandler.addResourceByCloud({ file, type, title, description });

                    clearInterval(progressInterval);
                    percent.textContent = '100%';
                }

                alert('æ·»åŠ æˆåŠŸï¼');
                document.getElementById('uploadForm').reset();

                // é‡ç½®æ–‡ä»¶é€‰æ‹©åŒºåŸŸ
                document.getElementById('dropZoneContent').classList.remove('hidden');
                document.getElementById('selectedFileInfo').classList.add('hidden');

                renderResources();
                updateStorageStats();
            } catch (error) {
                console.error('æ·»åŠ å¤±è´¥:', error);
                alert('æ·»åŠ å¤±è´¥ï¼š' + error.message);
            } finally {
                progress.classList.add('hidden');
            }
        }

        // ç­›é€‰èµ„æº
        function filterResources(type) {
            selectedType = type;
            renderResources();

            // æ›´æ–°æŒ‰é’®æ ·å¼
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('bg-gradient-to-r', 'from-purple-500', 'via-blue-500', 'to-green-500', 'text-white', 'shadow-lg');
                btn.classList.add('bg-white', 'text-gray-700');
            });

            const activeBtn = document.getElementById(`btn-${type}`);
            if (type === 'all') {
                activeBtn.classList.add('bg-gradient-to-r', 'from-purple-500', 'via-blue-500', 'to-green-500', 'text-white', 'shadow-lg');
            } else {
                activeBtn.style.background = 'linear-gradient(90deg, #8b5cf6, #3b82f6, #22c55e)';
                activeBtn.classList.add('text-white', 'shadow-lg');
            }
        }

        // æ¸²æŸ“èµ„æºåˆ—è¡¨
        function renderResources() {
            const container = document.getElementById('resources-container');
            const resources = uploadHandler.getResources(selectedType);

            if (resources.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8 sm:py-16">
                        <div class="text-6xl sm:text-8xl mb-4 animate-bounce">ğŸ“­</div>
                        <p class="text-gray-600 text-lg sm:text-xl">æš‚æ— èµ„æº</p>
                        <p class="text-gray-500 text-sm sm:text-base mt-2">é€‰æ‹©ä¸Šä¼ æ–¹å¼ï¼Œå¼€å§‹æ·»åŠ èµ„æºå§ï¼</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = `
                <div class="space-y-4">
                    ${resources.map(resource => {
                        const config = uploadHandler.typeConfig[resource.type];
                        const storageModeText = {
                            'url': 'ğŸ”— é“¾æ¥',
                            'base64': 'ğŸ’¾ æœ¬åœ°',
                            'cloud': 'â˜ï¸ äº‘ç«¯'
                        };
                        const storageModeClass = {
                            'url': 'bg-blue-100 text-blue-700',
                            'base64': 'bg-green-100 text-green-700',
                            'cloud': 'bg-purple-100 text-purple-700'
                        };

                        return `
                            <div class="border-2 ${config.borderColor} rounded-xl p-4 sm:p-6 hover:shadow-lg transition-all">
                                <div class="flex flex-col sm:flex-row sm:items-start justify-between gap-4">
                                    <div class="flex-1">
                                        <div class="flex flex-wrap items-center gap-2 mb-2">
                                            <span class="text-2xl">${config.emoji}</span>
                                            <span class="inline-flex items-center rounded-full px-3 py-1 text-xs font-bold ${config.textColor} ${config.bgColor}">
                                                ${config.label}
                                            </span>
                                            <span class="inline-flex items-center rounded-full px-2 py-1 text-xs font-bold ${storageModeClass[resource.storageMode]}">
                                                ${storageModeText[resource.storageMode]}
                                            </span>
                                        </div>
                                        <h3 class="text-lg sm:text-xl font-bold text-gray-900 mb-1">${resource.title}</h3>
                                        <p class="text-gray-600 text-sm mb-3">${resource.description || 'æš‚æ— æè¿°'}</p>
                                        <div class="flex flex-wrap gap-x-4 gap-y-1 text-xs text-gray-500">
                                            <span>ğŸ“… ${new Date(resource.uploadDate).toLocaleDateString()}</span>
                                            ${resource.size > 0 ? `<span>ğŸ“¦ ${uploadHandler.formatFileSize(resource.size)}</span>` : ''}
                                            ${resource.fileName ? `<span>ğŸ“„ ${resource.fileName}</span>` : ''}
                                        </div>
                                    </div>
                                    <div class="flex sm:flex-col gap-2">
                                        <a
                                            href="${resource.url}"
                                            target="_blank"
                                            rel="noopener noreferrer"
                                            class="px-4 py-2 rounded-lg ${config.btnColor} text-white font-bold text-sm transition-all hover:scale-105"
                                        >
                                            æ‰“å¼€
                                        </a>
                                        <button
                                            onclick="deleteResource('${resource.id}')"
                                            class="px-4 py-2 rounded-lg bg-red-500 hover:bg-red-600 text-white font-bold text-sm transition-all"
                                        >
                                            åˆ é™¤
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        // åˆ é™¤èµ„æº
        function deleteResource(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªèµ„æºå—ï¼Ÿ')) {
                uploadHandler.deleteResource(id);
                renderResources();
                updateStorageStats();
            }
        }

        // æ¸…ç©ºæ‰€æœ‰èµ„æº
        function clearAllResources() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰èµ„æºå—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                uploadHandler.clearAll();
                renderResources();
                updateStorageStats();
            }
        }

        // æ›´æ–°å­˜å‚¨ç»Ÿè®¡
        function updateStorageStats() {
            const resources = uploadHandler.getResources('all');

            const cloudCount = resources.filter(r => r.storageMode === 'cloud').length;
            const urlCount = resources.filter(r => r.storageMode === 'url').length;
            const base64Count = resources.filter(r => r.storageMode === 'base64').length;

            document.getElementById('cloudCount').textContent = cloudCount;
            document.getElementById('urlCount').textContent = urlCount;
            document.getElementById('base64Count').textContent = base64Count;
        }
    </script>
</body>
</html>
